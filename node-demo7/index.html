<title>首页</title>
<link rel="stylesheet" href="/style.css">
<h5>您的账户余额是<span id="amount">&&&amount&&&</span></h5>
<button id="button">付款1块钱</button>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script >
  button.addEventListener('click', (e) => {
    $.ajax({
      url: "http://jack.com:8002/pay",
      jsonp: "callback",
      dataType: "jsonp",
      success: function (response) {
        if(response === 'success') {
          amount.innerText = amount.innerText - 1 
        }  
      }
    })








    // let n = amount.innerText
    // let number = parseInt(n, 10)
    // let newNumber = number - 1
    // amount.innerText = newNumber
    //img请求法
    // let image = document.createElement('img')
    // image.src = '/pay'
    // image.onload = function() {
    //   alert('打钱成功')
    //   amount.innerText = amount.innerText - 1
    // }
    // image.onerror = function() {
    //   alert('打钱失败')
    // }
    
    //script请求法 
    // let script = document.createElement('script')
    // let functionName = 'wushao' + parseInt((Math.random()*100000), 10)
    // window[functionName] = function (result) {
    //   if (result === 'success') {
    //     amount.innerText = amount.innerText - 1
    //   } else {
    //   }
    // }
    // script.src = 'http://jack.com:8001/pay?callback=' + functionName
    // document.body.appendChild(script)
    // script.onload = function(e) {
    //   e.currentTarget.remove()
    //   delete window[functionName]
    // }
    // script.onerror = function(e) {
    //   alert('failed')
    //   e.currentTarget.remove()
    //   delete window[functionName]
    // }

  })
  
</script>